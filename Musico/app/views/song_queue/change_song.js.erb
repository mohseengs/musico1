$("#music-bar").html("<%= escape_javascript(render(partial: 'shared/music_player')) %>");
    progressBar = $('#progress-bar');
    audio = document.getElementById("song-audio");
    progress = 0;

    $('#next-button').on("click", function(){
        $.ajax({
            url: "/change_song/"+ <%= current_song_pointer.to_i + 1 %> + ".js",
            method: "GET" ,
            success: function(){
              progress = 0
              play();
            }
        });
    });

    $('#prev-button').on("click",function(){
        $.ajax({
            url: "/change_song/"+ <%= current_song_pointer.to_i - 1 %> + ".js",
            method: "GET" ,
            success: function(){
              progress = 0
              play();
            }
        });
    });

    $('#play-button').on("click",function(){
      if(audio.paused || audio.currentTime < 0){
          play();
      }
      else{
          pause();
      } 
    });

    function play(){
      audio.play();
      $('#play-button').attr('src', "assets/icons/pause-circle.svg");
    }
    function pause(){
      audio.pause();
      $('#play-button').attr('src', "assets/icons/play-circle.svg");

    }

    audio.addEventListener('timeupdate', ()=>{ 
          progress = parseInt((audio.currentTime/audio.duration)* 100); 
          $('#progress-bar').value = progress;
    });

    $('#progress-bar').change(()=>{
        audio.currentTime = progressBar.value * audio.duration/100;
    });