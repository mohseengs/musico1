<!DOCTYPE html>
<html>
  <head>
    <title>Musico</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload'%>
  </head>

  <body>

    <% if controller_name == "registrations" || controller_name == "sessions"  %>
      <div class="container-fluid auth-bg" > 
        <div class="row">
            <div class="col-6 auth-form-card">
                <%= yield %>
            </div>
            <div class="col-6 auth-form-card-img">
            
                <div class="row auth-form-text-on-img">
                    <h1>Musico</h1>
                    <p>music that suits your taste</p>
                </div>
            </div>
        </div>
      </div>
    <% else %>
      <div class="fluid-container">
        <div class="row">
          <%= render 'shared/sidebar' %>
          <div class="col-10 main">
            <div class='content'>
              <%= render 'shared/navbar' %>
              <%= yield %>
            </div>
          </div>
        </div>
        <div class="row">
          <%= render 'shared/music_player'%>
        </div>
    <% end %>
  </body>

<script>
    let playButton = document.getElementById('play-button');
    let nextButton = document.getElementById('next-button');
    let prevButton = document.getElementById('prev-button');

    let audio = document.getElementById("song-audio");
    let isPlaying = false;

    function playNextSong(){
      alert("sdknfkjsdnfjk");
      $.ajax({
        url: '/change_song/' +  <%= current_song_pointer %> + '.js' ,
        method: POST ,
        
        }); 
    }
    function playPreviousSong(){
        alert("previous song");
    }

    function playAudio(){
        

        if(!isPlaying){
            audio.play();
            playButton.src = "assets/icons/pause-circle.svg";
        }
        else{
    
            audio.pause();
            playButton.src = "assets/icons/play-circle.svg";
        }    
    }
    audio.onplaying = function() {
        isPlaying = true;
    };
    audio.onpause = function() {
        isPlaying = false;
    };
    playButton.addEventListener('click', playAudio);
    nextButton.addEventListener('click', playNextSong);
    prevButton.addEventListener('click', playPreviousSong);

</script>
  
</html>
